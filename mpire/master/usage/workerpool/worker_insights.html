

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Worker insights &mdash; mpire 2.10.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinxcontrib-images/LightBox2/lightbox2/css/lightbox.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dill" href="dill.html" />
    <link rel="prev" title="Keep alive" href="keep_alive.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> mpire
          

          
          </a>

          
            
            
              <div class="version">
                2.10.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to the MPIRE documentation!</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Usage</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">WorkerPool</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="setup.html">Starting a WorkerPool</a></li>
<li class="toctree-l3"><a class="reference internal" href="start_method.html">Process start method</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpu_pinning.html">CPU pinning</a></li>
<li class="toctree-l3"><a class="reference internal" href="worker_id.html">Accessing the worker ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="shared_objects.html">Shared objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="worker_state.html">Worker state</a></li>
<li class="toctree-l3"><a class="reference internal" href="keep_alive.html">Keep alive</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Worker insights</a></li>
<li class="toctree-l3"><a class="reference internal" href="dill.html">Dill</a></li>
<li class="toctree-l3"><a class="reference internal" href="order_tasks.html">Order tasks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../map/index.html">Map family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apply.html">Apply family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dashboard.html">Dashboard</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contribution guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">mpire</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Usage</a> &raquo;</li>
        
          <li><a href="index.html">WorkerPool</a> &raquo;</li>
        
      <li>Worker insights</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/usage/workerpool/worker_insights.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="worker-insights">
<span id="id1"></span><h1>Worker insights<a class="headerlink" href="#worker-insights" title="Permalink to this headline">¶</a></h1>
<p>Worker insights gives you insight in your multiprocessing efficiency by tracking worker start up time, waiting time and
time spend on executing tasks. Tracking is disabled by default, but can be enabled by setting <code class="docutils literal notranslate"><span class="pre">enable_insights</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">WorkerPool</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">enable_insights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
<p>The overhead is very minimal and you shouldn’t really notice it, even on very small tasks. You can view the tracking
results using <a class="reference internal" href="../../reference/index.html#mpire.WorkerPool.get_insights" title="mpire.WorkerPool.get_insights"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mpire.WorkerPool.get_insights()</span></code></a> or use <a class="reference internal" href="../../reference/index.html#mpire.WorkerPool.print_insights" title="mpire.WorkerPool.print_insights"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mpire.WorkerPool.print_insights()</span></code></a> to directly print
the insights to console:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">sleep_and_square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># For illustration purposes</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>

<span class="k">with</span> <span class="n">WorkerPool</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">enable_insights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sleep_and_square</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
    <span class="n">insights</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">get_insights</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">insights</span><span class="p">)</span>

<span class="c1"># Output:</span>
<span class="p">{</span><span class="s1">&#39;n_completed_tasks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span>
 <span class="s1">&#39;total_start_up_time&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00.038&#39;</span><span class="p">,</span>
 <span class="s1">&#39;total_init_time&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;total_waiting_time&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00.798&#39;</span><span class="p">,</span>
 <span class="s1">&#39;total_working_time&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:04.980&#39;</span><span class="p">,</span>
 <span class="s1">&#39;total_exit_time&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;total_time&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:05.816&#39;</span><span class="p">,</span>
 <span class="s1">&#39;start_up_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0:00:00.010&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.008&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.008&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.011&#39;</span><span class="p">],</span>
 <span class="s1">&#39;start_up_time_mean&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00.009&#39;</span><span class="p">,</span>
 <span class="s1">&#39;start_up_time_std&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00.001&#39;</span><span class="p">,</span>
 <span class="s1">&#39;start_up_ratio&#39;</span><span class="p">:</span> <span class="mf">0.006610452621805033</span><span class="p">,</span>
 <span class="s1">&#39;init_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">],</span>
 <span class="s1">&#39;init_time_mean&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;init_time_std&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;init_ratio&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;waiting_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0:00:00.309&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.311&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.165&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.012&#39;</span><span class="p">],</span>
 <span class="s1">&#39;waiting_time_mean&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00.199&#39;</span><span class="p">,</span>
 <span class="s1">&#39;waiting_time_std&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00.123&#39;</span><span class="p">,</span>
 <span class="s1">&#39;waiting_ratio&#39;</span><span class="p">:</span> <span class="mf">0.13722942739284952</span><span class="p">,</span>
 <span class="s1">&#39;working_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0:00:01.142&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:01.135&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:01.278&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:01.423&#39;</span><span class="p">],</span>
 <span class="s1">&#39;working_time_mean&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:01.245&#39;</span><span class="p">,</span>
 <span class="s1">&#39;working_time_std&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00.117&#39;</span><span class="p">,</span>
 <span class="s1">&#39;working_ratio&#39;</span><span class="p">:</span> <span class="mf">0.8561601182661567</span><span class="p">,</span>
 <span class="s1">&#39;exit_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">]</span>
 <span class="s1">&#39;exit_time_mean&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;exit_time_std&#39;</span><span class="p">:</span> <span class="s1">&#39;0:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;exit_ratio&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;top_5_max_task_durations&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0:00:00.099&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.098&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.097&#39;</span><span class="p">,</span> <span class="s1">&#39;0:00:00.096&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;0:00:00.095&#39;</span><span class="p">],</span>
 <span class="s1">&#39;top_5_max_task_args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Arg 0: 99&#39;</span><span class="p">,</span> <span class="s1">&#39;Arg 0: 98&#39;</span><span class="p">,</span> <span class="s1">&#39;Arg 0: 97&#39;</span><span class="p">,</span> <span class="s1">&#39;Arg 0: 96&#39;</span><span class="p">,</span> <span class="s1">&#39;Arg 0: 95&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<p>We specified 4 workers, so there are 4 entries in the <code class="docutils literal notranslate"><span class="pre">n_completed_tasks</span></code>, <code class="docutils literal notranslate"><span class="pre">start_up_time</span></code>, <code class="docutils literal notranslate"><span class="pre">init_time</span></code>,
<code class="docutils literal notranslate"><span class="pre">waiting_time</span></code>, <code class="docutils literal notranslate"><span class="pre">working_time</span></code>, and <code class="docutils literal notranslate"><span class="pre">exit_time</span></code> containers. They show per worker the number of completed tasks,
the total start up time, the total time spend on the <code class="docutils literal notranslate"><span class="pre">worker_init</span></code> function, the total time waiting for new tasks,
total time spend on main function, and the total time spend on the <code class="docutils literal notranslate"><span class="pre">worker_exit</span></code> function, respectively. The insights
also contain mean, standard deviation, and ratio of the tracked time. The ratio is the time for that part divided by the
total time. In general, the higher the working ratio the more efficient your multiprocessing setup is. Of course, your
setup might still not be optimal because the task itself is inefficient, but timing that is beyond the scope of MPIRE.</p>
<p>Additionally, the insights keep track of the top 5 tasks that took the longest to run. The data is split up in two
containers: one for the duration and one for the arguments that were passed on to the task function. Both are sorted
based on task duration (desc), so index <code class="docutils literal notranslate"><span class="pre">0</span></code> of the args list corresponds to index <code class="docutils literal notranslate"><span class="pre">0</span></code> of the duration list, etc.</p>
<p>When using the MPIRE <a class="reference internal" href="../dashboard.html#dashboard"><span class="std std-ref">Dashboard</span></a> you can track these insights in real-time. See <a class="reference internal" href="../dashboard.html#dashboard"><span class="std std-ref">Dashboard</span></a> for more
information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <cite>imap</cite> or <cite>imap_unordered</cite> you can view the insights during execution. Simply call <code class="docutils literal notranslate"><span class="pre">get_insights()</span></code>
or <code class="docutils literal notranslate"><span class="pre">print_insights()</span></code> inside your loop where you process the results.</p>
</div>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dill.html" class="btn btn-neutral float-right" title="Dill" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="keep_alive.html" class="btn btn-neutral float-left" title="Keep alive" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2024, Sybren Jansen

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: master
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../../v1.1.2/index.html">v1.1.2</a></dd>
            <dd><a href="../../../v1.1.3/index.html">v1.1.3</a></dd>
            <dd><a href="../../../v1.2.0/index.html">v1.2.0</a></dd>
            <dd><a href="../../../v1.2.1/index.html">v1.2.1</a></dd>
            <dd><a href="../../../v1.2.2/index.html">v1.2.2</a></dd>
            <dd><a href="../../../v2.0.0/index.html">v2.0.0</a></dd>
            <dd><a href="../../../v2.1.0/index.html">v2.1.0</a></dd>
            <dd><a href="../../../v2.1.1/index.html">v2.1.1</a></dd>
            <dd><a href="../../../v2.10.0/usage/workerpool/worker_insights.html">v2.10.0</a></dd>
            <dd><a href="../../../v2.10.1/usage/workerpool/worker_insights.html">v2.10.1</a></dd>
            <dd><a href="../../../v2.2.0/index.html">v2.2.0</a></dd>
            <dd><a href="../../../v2.2.1/index.html">v2.2.1</a></dd>
            <dd><a href="../../../v2.3.0/usage/workerpool/worker_insights.html">v2.3.0</a></dd>
            <dd><a href="../../../v2.3.1/usage/workerpool/worker_insights.html">v2.3.1</a></dd>
            <dd><a href="../../../v2.3.2/usage/workerpool/worker_insights.html">v2.3.2</a></dd>
            <dd><a href="../../../v2.3.3/usage/workerpool/worker_insights.html">v2.3.3</a></dd>
            <dd><a href="../../../v2.3.4/usage/workerpool/worker_insights.html">v2.3.4</a></dd>
            <dd><a href="../../../v2.3.5/usage/workerpool/worker_insights.html">v2.3.5</a></dd>
            <dd><a href="../../../v2.4.0/usage/workerpool/worker_insights.html">v2.4.0</a></dd>
            <dd><a href="../../../v2.5.0/usage/workerpool/worker_insights.html">v2.5.0</a></dd>
            <dd><a href="../../../v2.6.0/usage/workerpool/worker_insights.html">v2.6.0</a></dd>
            <dd><a href="../../../v2.7.0/usage/workerpool/worker_insights.html">v2.7.0</a></dd>
            <dd><a href="../../../v2.7.1/usage/workerpool/worker_insights.html">v2.7.1</a></dd>
            <dd><a href="../../../v2.8.0/usage/workerpool/worker_insights.html">v2.8.0</a></dd>
            <dd><a href="../../../v2.8.1/usage/workerpool/worker_insights.html">v2.8.1</a></dd>
            <dd><a href="../../../v2.9.0/usage/workerpool/worker_insights.html">v2.9.0</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="worker_insights.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>