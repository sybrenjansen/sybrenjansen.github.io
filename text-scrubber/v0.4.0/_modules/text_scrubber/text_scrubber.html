

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>text_scrubber.text_scrubber &mdash; text-scrubber 0.4.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> text-scrubber
          

          
          </a>

          
            
            
              <div class="version">
                0.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">text-scrubber documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Change log</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">text-scrubber</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>text_scrubber.text_scrubber</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for text_scrubber.text_scrubber</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">filterfalse</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">punctuation</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Match</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span>

<span class="kn">from</span> <span class="nn">anyascii</span> <span class="kn">import</span> <span class="n">anyascii</span>
<span class="kn">from</span> <span class="nn">num2words</span> <span class="kn">import</span> <span class="n">num2words</span>

<span class="kn">from</span> <span class="nn">text_scrubber.io</span> <span class="kn">import</span> <span class="n">read_resource_file</span>

<span class="n">WholeText</span> <span class="o">=</span> <span class="nb">str</span>
<span class="n">Token</span> <span class="o">=</span> <span class="nb">str</span>
<span class="n">TokenizedText</span> <span class="o">=</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Token</span><span class="p">]</span>
<span class="n">AnyText</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">WholeText</span><span class="p">,</span> <span class="n">TokenizedText</span><span class="p">]</span>

<span class="c1"># Precompile some regex objects</span>
<span class="n">RE_TOKENIZE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[.,!?:;*\-()\[\]\s_</span><span class="se">\\</span><span class="s1">/]+&#39;</span><span class="p">)</span>
<span class="n">RE_STRIP_QUOTES</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;|</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">RE_FIND_DIGIT</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">)</span>

<span class="c1"># Read in a list of stop words</span>
<span class="n">STOP_WORDS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">read_resource_file</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="s1">&#39;resources/stopwords.txt&#39;</span><span class="p">))</span>

<span class="c1"># The Greek alphabet</span>
<span class="n">TOKEN_MAP_GREEK</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Α&#39;</span><span class="p">:</span> <span class="s1">&#39;Alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;α&#39;</span><span class="p">:</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;Β&#39;</span><span class="p">:</span> <span class="s1">&#39;Beta&#39;</span><span class="p">,</span> <span class="s1">&#39;β&#39;</span><span class="p">:</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;Γ&#39;</span><span class="p">:</span> <span class="s1">&#39;Gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;γ&#39;</span><span class="p">:</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;Δ&#39;</span><span class="p">:</span> <span class="s1">&#39;Delta&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;δ&#39;</span><span class="p">:</span> <span class="s1">&#39;delta&#39;</span><span class="p">,</span> <span class="s1">&#39;Ε&#39;</span><span class="p">:</span> <span class="s1">&#39;Epsilon&#39;</span><span class="p">,</span> <span class="s1">&#39;ε&#39;</span><span class="p">:</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">,</span> <span class="s1">&#39;Ζ&#39;</span><span class="p">:</span> <span class="s1">&#39;Zeta&#39;</span><span class="p">,</span> <span class="s1">&#39;ζ&#39;</span><span class="p">:</span> <span class="s1">&#39;zeta&#39;</span><span class="p">,</span> <span class="s1">&#39;Η&#39;</span><span class="p">:</span> <span class="s1">&#39;Eta&#39;</span><span class="p">,</span> <span class="s1">&#39;η&#39;</span><span class="p">:</span> <span class="s1">&#39;eta&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Θ&#39;</span><span class="p">:</span> <span class="s1">&#39;Theta&#39;</span><span class="p">,</span> <span class="s1">&#39;θ&#39;</span><span class="p">:</span> <span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="s1">&#39;Ι&#39;</span><span class="p">:</span> <span class="s1">&#39;Iota&#39;</span><span class="p">,</span> <span class="s1">&#39;ι&#39;</span><span class="p">:</span> <span class="s1">&#39;ia&#39;</span><span class="p">,</span> <span class="s1">&#39;Κ&#39;</span><span class="p">:</span> <span class="s1">&#39;Kappa&#39;</span><span class="p">,</span> <span class="s1">&#39;κ&#39;</span><span class="p">:</span> <span class="s1">&#39;kappa&#39;</span><span class="p">,</span> <span class="s1">&#39;Λ&#39;</span><span class="p">:</span> <span class="s1">&#39;Lambda&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;λ&#39;</span><span class="p">:</span> <span class="s1">&#39;lambda&#39;</span><span class="p">,</span> <span class="s1">&#39;Μ&#39;</span><span class="p">:</span> <span class="s1">&#39;Mu&#39;</span><span class="p">,</span> <span class="s1">&#39;μ&#39;</span><span class="p">:</span> <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;Ν&#39;</span><span class="p">:</span> <span class="s1">&#39;Nu&#39;</span><span class="p">,</span> <span class="s1">&#39;ν&#39;</span><span class="p">:</span> <span class="s1">&#39;nu&#39;</span><span class="p">,</span> <span class="s1">&#39;Ξ&#39;</span><span class="p">:</span> <span class="s1">&#39;Xi&#39;</span><span class="p">,</span> <span class="s1">&#39;ξ&#39;</span><span class="p">:</span> <span class="s1">&#39;xi&#39;</span><span class="p">,</span> <span class="s1">&#39;Ο&#39;</span><span class="p">:</span> <span class="s1">&#39;Omicron&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ο&#39;</span><span class="p">:</span> <span class="s1">&#39;omicron&#39;</span><span class="p">,</span> <span class="s1">&#39;Π&#39;</span><span class="p">:</span> <span class="s1">&#39;Pi&#39;</span><span class="p">,</span> <span class="s1">&#39;π&#39;</span><span class="p">:</span> <span class="s1">&#39;pi&#39;</span><span class="p">,</span> <span class="s1">&#39;Ρ&#39;</span><span class="p">:</span> <span class="s1">&#39;Rho&#39;</span><span class="p">,</span> <span class="s1">&#39;ρ&#39;</span><span class="p">:</span> <span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="s1">&#39;Σ&#39;</span><span class="p">:</span> <span class="s1">&#39;Sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;σ&#39;</span><span class="p">:</span> <span class="s1">&#39;sigma&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ς&#39;</span><span class="p">:</span> <span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;Ϲ&#39;</span><span class="p">:</span> <span class="s1">&#39;Sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;ϲ&#39;</span><span class="p">:</span> <span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;Τ&#39;</span><span class="p">:</span> <span class="s1">&#39;Tau&#39;</span><span class="p">,</span> <span class="s1">&#39;τ&#39;</span><span class="p">:</span> <span class="s1">&#39;tau&#39;</span><span class="p">,</span> <span class="s1">&#39;Υ&#39;</span><span class="p">:</span> <span class="s1">&#39;Upsilon&#39;</span><span class="p">,</span> <span class="s1">&#39;υ&#39;</span><span class="p">:</span> <span class="s1">&#39;upsilon&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Φ&#39;</span><span class="p">:</span> <span class="s1">&#39;Phi&#39;</span><span class="p">,</span> <span class="s1">&#39;φ&#39;</span><span class="p">:</span> <span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="s1">&#39;Χ&#39;</span><span class="p">:</span> <span class="s1">&#39;Chi&#39;</span><span class="p">,</span> <span class="s1">&#39;χ&#39;</span><span class="p">:</span> <span class="s1">&#39;chi&#39;</span><span class="p">,</span> <span class="s1">&#39;Ψ&#39;</span><span class="p">:</span> <span class="s1">&#39;Psi&#39;</span><span class="p">,</span> <span class="s1">&#39;ψ&#39;</span><span class="p">:</span> <span class="s1">&#39;psi&#39;</span><span class="p">,</span> <span class="s1">&#39;Ω&#39;</span><span class="p">:</span> <span class="s1">&#39;Omega&#39;</span><span class="p">,</span> <span class="s1">&#39;ω&#39;</span><span class="p">:</span> <span class="s1">&#39;omega&#39;</span><span class="p">}</span>


<span class="k">class</span> <span class="nc">TextTransformer</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param operation: A callable that is used to preprocess the text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="n">operation</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">TokenTransformer</span><span class="p">(</span><span class="n">TextTransformer</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param operation: A callable that is used to preprocess a single token.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="k">lambda</span> <span class="n">X</span><span class="p">:</span> <span class="p">[</span><span class="n">operation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">])</span>


<div class="viewcode-block" id="TextScrubber"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber">[docs]</a><span class="k">class</span> <span class="nc">TextScrubber</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cleans a single or a collection of strings.</span>

<span class="sd">    Can be easily constructed and configured with building blocks::</span>

<span class="sd">        ts = (TextScrubber().lowercase()</span>
<span class="sd">                             .strip_accents()</span>
<span class="sd">                             .tokenize()</span>
<span class="sd">                             .remove_stop_words()</span>
<span class="sd">                             .join())</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TextScrubber.__init__"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Initialize empty pipeline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleaner</span> <span class="o">=</span> <span class="p">[]</span></div>

    <span class="k">def</span> <span class="nf">_add_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a single step to the pipeline.</span>

<span class="sd">        :param name: Name of the step.</span>
<span class="sd">        :param func: Callable function/object which performs a transformation.</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">transformer</span> <span class="o">=</span> <span class="n">TokenTransformer</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="k">if</span> <span class="n">on_tokens</span> <span class="k">else</span> <span class="n">TextTransformer</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleaner</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cleaner</span><span class="p">)),</span> <span class="n">transformer</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="TextScrubber.text_transform"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.text_transform">[docs]</a>    <span class="k">def</span> <span class="nf">text_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">AnyText</span><span class="p">],</span> <span class="n">AnyText</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;string_transform&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a function operating on texts to the pipeline.</span>

<span class="sd">        :param func: Function to perform on whole strings.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.token_transform"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.token_transform">[docs]</a>    <span class="k">def</span> <span class="nf">token_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Token</span><span class="p">],</span> <span class="n">Token</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;token_transform&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a function operating on tokens to the pipeline.</span>

<span class="sd">        :param func: Function to perform on each token.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.transform"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">AnyText</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">AnyText</span><span class="p">]],</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">to_set</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">AnyText</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">AnyText</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transform a single or multiple strings.</span>

<span class="sd">        :param s: One or multiple texts, which can either be tokenized or not.</span>
<span class="sd">        :param on_tokens: Whether to treat the iterable of strings as tokens or complete strings.</span>
<span class="sd">        :param to_set: Whether to return a set instead of a list when an iterable of strings is provided.</span>
<span class="sd">        :return: Cleaned string or set of cleaned strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">on_tokens</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
            <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">((</span><span class="n">s</span><span class="p">,))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cleaned_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">cleaned_s</span><span class="p">)</span> <span class="k">if</span> <span class="n">to_set</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">cleaned_s</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.transform_generator"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.transform_generator">[docs]</a>    <span class="k">def</span> <span class="nf">transform_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">AnyText</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">AnyText</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transform multiple strings and receive a generator as result.</span>

<span class="sd">        :param s: Iterable of strings.</span>
<span class="sd">        :return: Generator of cleaned strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">AnyText</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">AnyText</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls the entire cleaning pipeline on the iterable of strings.</span>

<span class="sd">        :param s: Iterable of strings to transform.</span>
<span class="sd">        :return: Cleaned string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaner</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>

<div class="viewcode-block" id="TextScrubber.__repr__"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays the cleaning pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">cleaner</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span></div>

    <span class="fm">__str__</span> <span class="o">=</span> <span class="fm">__repr__</span>

    <span class="c1">##################</span>
    <span class="c1"># Building blocks</span>
    <span class="c1">##################</span>

<div class="viewcode-block" id="TextScrubber.filter_tokens"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.filter_tokens">[docs]</a>    <span class="k">def</span> <span class="nf">filter_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Token</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="n">neg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;filter_tokens&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter tokens given a certain test.</span>

<span class="sd">        :param test: Function which should return ``False`` when a token should be removed.</span>
<span class="sd">        :param neg: Whether the test should be reversed.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">partial</span><span class="p">(</span><span class="n">filterfalse</span> <span class="k">if</span> <span class="n">neg</span> <span class="k">else</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">test</span><span class="p">),</span> <span class="n">on_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.initials"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.initials">[docs]</a>    <span class="k">def</span> <span class="nf">initials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;initials&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all, but the first element of a text or tokens.</span>

<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">on_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.join"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;join&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Joins elements to a single string.</span>

<span class="sd">        :param sep: Separator to join tokens.</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.lowercase"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.lowercase">[docs]</a>    <span class="k">def</span> <span class="nf">lowercase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;lowercase&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lowercases text or tokens.</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.num2words"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.num2words">[docs]</a>    <span class="k">def</span> <span class="nf">num2words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_commas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;num2words&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts numbers like ``42`` to words like ``forty-two``. See https://github.com/savoirfairelinux/num2words.</span>

<span class="sd">        :param include_commas: Whether to let num2words include commas for more natural reading.</span>
<span class="sd">        :param language: The language in which to convert the number (see num2words documentation for possible values).</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="c1"># Split word at digit positions (if any), remove leading and trailing empty parts</span>
                <span class="n">digits_span</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">RE_FIND_DIGIT</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">span</span><span class="p">()]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="n">digits_span</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">digits_span</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">digits_span</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="p">(</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">))</span>

                <span class="c1"># Try to parse the token in to a number. If it succeeds, convert to text. If not, do not convert</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">num_words</span> <span class="o">=</span> <span class="n">num2words</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">token</span><span class="p">),</span> <span class="n">lang</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
                        <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_words</span> <span class="k">if</span> <span class="n">include_commas</span> <span class="k">else</span> <span class="n">num_words</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

            <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">_transform</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.remove_digits"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.remove_digits">[docs]</a>    <span class="k">def</span> <span class="nf">remove_digits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;remove_digits&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes digits from text or tokens.</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">char</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">t</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()),</span> <span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.remove_excessive_whitespace"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.remove_excessive_whitespace">[docs]</a>    <span class="k">def</span> <span class="nf">remove_excessive_whitespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;strip_excessive_whitespace&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replaces multi-character whitespace with a single whitespace.</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">()),</span> <span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.remove_html_tags"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.remove_html_tags">[docs]</a>    <span class="k">def</span> <span class="nf">remove_html_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;remove_html_tags&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all HTML tags (i.e., everything that matches ``r&#39;&lt;.*?&gt;&#39;``).</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;.*?&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.removes_prefixes"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.removes_prefixes">[docs]</a>    <span class="k">def</span> <span class="nf">removes_prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;strip_prefix&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes a set of prefixes.</span>

<span class="sd">        :param prefixes: Set of prefixes to remove.</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;^</span><span class="si">{</span><span class="s1">&#39;|^&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prefixes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.remove_punctuation"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.remove_punctuation">[docs]</a>    <span class="k">def</span> <span class="nf">remove_punctuation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_punctuation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;remove_punctuation&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all, but the provided punctuation from text or tokens.</span>

<span class="sd">        :param keep_punctuation: A string containing the punctuation-tokens that should NOT be removed.</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cleanup_table</span> <span class="o">=</span> <span class="p">{</span><span class="nb">ord</span><span class="p">(</span><span class="n">punct</span><span class="p">):</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">punct</span> <span class="ow">in</span> <span class="n">punctuation</span> <span class="k">if</span> <span class="n">punct</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keep_punctuation</span><span class="p">}</span>
        <span class="n">remove_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_remove_punctuation</span><span class="p">,</span> <span class="n">cleanup_table</span><span class="o">=</span><span class="n">cleanup_table</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">remove_func</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.remove_quotes"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.remove_quotes">[docs]</a>    <span class="k">def</span> <span class="nf">remove_quotes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;strip_quotes&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes single and double quotes from text or tokens.</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">RE_STRIP_QUOTES</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.remove_stop_words"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.remove_stop_words">[docs]</a>    <span class="k">def</span> <span class="nf">remove_stop_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stop_words</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;remove_stop_words&#39;</span><span class="p">,</span>
                          <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes stop words. All-caps tokens are considered to be abbreviations and are retained.</span>

<span class="sd">        :param case_sensitive: should the stopword removal be case_sensitive or not</span>
<span class="sd">        :param stop_words: Iterable of stop words to remove. If not provided it will use a default list of stop words.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stop_words_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stop_words</span><span class="p">)</span> <span class="k">if</span> <span class="n">stop_words</span> <span class="k">else</span> <span class="n">STOP_WORDS</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span><span class="p">:</span>
            <span class="n">remove_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">filter</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words_set</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">remove_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">filter</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="ow">or</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words_set</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">remove_func</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.remove_suffixes"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.remove_suffixes">[docs]</a>    <span class="k">def</span> <span class="nf">remove_suffixes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">suffixes</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;strip_suffix&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes a set of suffixes.</span>

<span class="sd">        :param suffixes: Set of suffixes to remove.</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;$|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">suffixes</span><span class="p">)</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.sort"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sort&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sort text or tokens.</span>

<span class="sd">        :param reverse: Reverse sort.</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">tokens</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">),</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.strip"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.strip">[docs]</a>    <span class="k">def</span> <span class="nf">strip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chars</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;strip&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Uses the builtin ``str.strip`` function to strip leading/trailing characters from text or tokens.</span>

<span class="sd">        :param chars: If chars is given and not None, remove leading/trailing characters in chars instead of whitespace.</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strip_func</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">strip</span> <span class="k">if</span> <span class="n">chars</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">strip_func</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.sub"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.sub">[docs]</a>    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">],</span> <span class="n">replace</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Match</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">str</span><span class="p">]],</span>
            <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sub&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace all occurrences of a search query with a replacement string.</span>

<span class="sd">        :param search: String or regex on which to match.</span>
<span class="sd">        :param replace: Replacement string or callable for matched groups.</span>
<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">search_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>
        <span class="n">sub_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">search_re</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">replace</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">sub_func</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.sub_greek_chars"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.sub_greek_chars">[docs]</a>    <span class="k">def</span> <span class="nf">sub_greek_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sub_greek_chars&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace Greek characters with their English name. E.g., ``α`` is replaced by ``alpha``.</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TOKEN_MAP_GREEK</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">t</span><span class="p">),</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.sub_html_chars"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.sub_html_chars">[docs]</a>    <span class="k">def</span> <span class="nf">sub_html_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sub_html_chars&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Match HTML char encodings such as ``&amp;#410;`` and replaces them with the equivalent unicode character.</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&amp;#(\d{1,3});&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))),</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.sub_latex_chars"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.sub_latex_chars">[docs]</a>    <span class="k">def</span> <span class="nf">sub_latex_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sub_latex_chars&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Match accented LaTeX commands such as ``\&quot;{o}`` and ``\^{\i}`` OR match direct commands such as ``\o`` and</span>
<span class="sd">        ``\l{}`` and ``{\L}``, and keep only the regular ascii character.</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">latex_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">[Hhckbdruvt&#39;</span><span class="se">\&quot;</span><span class="s2">~`^=.]{?</span><span class="se">\\</span><span class="s2">?([a-zA-Z]+)}?|{?</span><span class="se">\\</span><span class="s2">([LlOoIiJj]</span><span class="si">{1}</span><span class="s2">)}?{?}?&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">latex_re</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">on_tokens</span><span class="o">=</span><span class="n">on_tokens</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.sub_tokens"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.sub_tokens">[docs]</a>    <span class="k">def</span> <span class="nf">sub_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Token</span><span class="p">],</span> <span class="n">Token</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;substitute_tokens&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Substitutes tokens.</span>

<span class="sd">        :param func: Function that substitutes tokens.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.to_ascii"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.to_ascii">[docs]</a>    <span class="k">def</span> <span class="nf">to_ascii</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;to_ascii&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Uses ``anyascii`` to strip accents and convert unicode characters to plain 7-bit ASCII.</span>

<span class="sd">        :param on_tokens: Whether to transform on a list of tokens or a single string.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">anyascii</span><span class="p">,</span> <span class="n">on_tokens</span><span class="p">)</span></div>

    <span class="c1"># Alias</span>
    <span class="n">strip_accents</span> <span class="o">=</span> <span class="n">to_ascii</span>

<div class="viewcode-block" id="TextScrubber.to_list"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.to_list">[docs]</a>    <span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;to_list&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the iterable of tokens to a list (useful when not joining as you&#39;re otherwise left with generator or</span>
<span class="sd">        ``filter`` objects which still need to be evaluated).</span>

<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">on_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextScrubber.tokenize"><a class="viewcode-back" href="../../reference.html#text_scrubber.text_scrubber.TextScrubber.tokenize">[docs]</a>    <span class="k">def</span> <span class="nf">tokenize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">WholeText</span><span class="p">],</span> <span class="n">TokenizedText</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;tokenize&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TextScrubber&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tokenizes a text.</span>

<span class="sd">        :param func: Function used for tokenizing a string. None to use the default tokenizer.</span>
<span class="sd">        :param name: Name to give to the pipeline step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">func</span> <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">RE_TOKENIZE</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_step</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div></div>


<span class="k">def</span> <span class="nf">_remove_punctuation</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cleanup_table</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes punctuation from a text given a cleanup table.</span>

<span class="sd">    :param text: String to clean.</span>
<span class="sd">    :param cleanup_table: Translation tabel mapping punctuation ordinals to None.</span>
<span class="sd">    :return: Cleaned string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">cleanup_table</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2023, Slimmer AI

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: v0.4.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../../v0.1/index.html">v0.1</a></dd>
            <dd><a href="../../../v0.1.1/index.html">v0.1.1</a></dd>
            <dd><a href="../../../v0.2.0/index.html">v0.2.0</a></dd>
            <dd><a href="../../../v0.3.0/index.html">v0.3.0</a></dd>
            <dd><a href="../../../v0.3.1/index.html">v0.3.1</a></dd>
            <dd><a href="../../../v0.3.2/index.html">v0.3.2</a></dd>
            <dd><a href="text_scrubber.html">v0.4.0</a></dd>
            <dd><a href="../../../v0.4.1/index.html">v0.4.1</a></dd>
            <dd><a href="../../../v0.4.2/index.html">v0.4.2</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../master/index.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>